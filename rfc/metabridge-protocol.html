<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>MetaBridge Protocol (MBP)</title>
<meta content="Yannik Goldgräbe" name="author">
<meta content="Marco Lewandowsky" name="author">
<meta content="
       The MetaBridge Protocol 1.0 is an extension to the  ERC-721: Non-Fungible Token Standard  as introduced to Ethereum with  EIP-721 . It enables a hard cryptographic binding of physical assets to the NFT as well as independent claiming of such assets by introducing the role of a creator that transmits a claiming code to the user. 
       This specification defines the core MetaBridge functionality: binding a physical anchor to the NFT and the use of a claiming code to gain ownership thereof. It also describes the security and privacy considerations for using the MetaBridge Protocol. 
    " name="description">
<meta content="xml2rfc 3.12.4" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-metabridge-dinrg-protocol-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.4
    Python 3.9.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.1
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.8.0
    MarkupSafe 2.0.1
    pycountry 22.3.5
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 60.10.0
    six 1.16.0
-->
<link href="metabridge-protocol.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">MBP</td>
<td class="right">January 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Goldgräbe &amp; Lewandowsky</td>
<td class="center">Expires 27 July 2023</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Decentralized Internet Infrastructure</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-metabridge-dinrg-protocol-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-01-23" class="published">23 January 2023</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Experimental</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2023-07-27">27 July 2023</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">Y. Goldgräbe</div>
<div class="org">yannik.gold</div>
</div>
<div class="author">
      <div class="author-name">M. Lewandowsky</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">MetaBridge Protocol (MBP)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The MetaBridge Protocol 1.0 is an extension to the <a href="https://ethereum.org/en/developers/docs/standards/tokens/erc-721/">ERC-721: Non-Fungible Token Standard</a> as introduced to Ethereum with <a href="https://eips.ethereum.org/EIPS/eip-721">EIP-721</a>. It enables a hard cryptographic binding of physical assets to the NFT as well as independent claiming of such assets by introducing the role of a creator that transmits a claiming code to the user.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This specification defines the core MetaBridge functionality: binding a physical anchor to the NFT and the use of a claiming code to gain ownership thereof. It also describes the security and privacy considerations for using the MetaBridge Protocol.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://open-metabridge-foundation.github.io/open-metabridge-foundation/protocol/metabridge-protocol.html">https://open-metabridge-foundation.github.io/open-metabridge-foundation/protocol/metabridge-protocol.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-metabridge-dinrg-protocol/">https://datatracker.ietf.org/doc/draft-metabridge-dinrg-protocol/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Decentralized Internet Infrastructure Research Group mailing list (<span><a href="mailto:din@irtf.org">mailto:din@irtf.org</a></span>),
        which is archived at <span><a href="https://www.ietf.org/mail-archive/web/din/current/maillist.html">https://www.ietf.org/mail-archive/web/din/current/maillist.html</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/open-metabridge-foundation/protocol">https://github.com/open-metabridge-foundation/protocol</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 27 July 2023.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-status" class="xref">Status</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-roles" class="xref">Roles</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1" class="keepWithNext"><a href="#section-2.1.1" class="xref">2.1.1</a>.  <a href="#name-item" class="xref">Item</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1" class="keepWithNext"><a href="#section-2.1.2" class="xref">2.1.2</a>.  <a href="#name-ancnft-pnft" class="xref">ancNFT / pNFT</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.3">
                    <p id="section-toc.1-1.2.2.1.2.3.1"><a href="#section-2.1.3" class="xref">2.1.3</a>.  <a href="#name-creator" class="xref">Creator</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.4">
                    <p id="section-toc.1-1.2.2.1.2.4.1"><a href="#section-2.1.4" class="xref">2.1.4</a>.  <a href="#name-user" class="xref">User</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.5">
                    <p id="section-toc.1-1.2.2.1.2.5.1"><a href="#section-2.1.5" class="xref">2.1.5</a>.  <a href="#name-distributed-ledger-smart-co" class="xref">Distributed Ledger (Smart Contract Platform)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-protocol-flow" class="xref">Protocol Flow</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-interoperability" class="xref">Interoperability</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-tag-object-registration" class="xref">Tag/Object registration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-tag-requirements" class="xref">Tag requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="xref">3.1.1</a>.  <a href="#name-general-requirements" class="xref">General Requirements</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="xref">3.1.2</a>.  <a href="#name-hardware-requirements" class="xref">Hardware Requirements</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#section-3.1.3" class="xref">3.1.3</a>.  <a href="#name-additional-assumptions" class="xref">Additional Assumptions</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-tag-identifier" class="xref">Tag identifier</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="xref">3.2.1</a>.  <a href="#name-lookup-metadata" class="xref">Lookup Metadata</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="xref">3.2.2</a>.  <a href="#name-verify-proof-of-possession" class="xref">Verify Proof-of-Possession</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-protocol-smartcontract-endp" class="xref">Protocol/Smartcontract endpoints</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-query-identifier" class="xref">Query identifier</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-register-object" class="xref">Register object</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-claim-object" class="xref">Claim object</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-claiming-ownership" class="xref">Claiming ownership</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-transfering-ownership" class="xref">Transfering ownership</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-verifying-ownership" class="xref">Verifying ownership</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-assumptions" class="xref">Assumptions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-mathematical-proof" class="xref">(Mathematical proof)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-privacy-considerations" class="xref">Privacy considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-references" class="xref">References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-appendix" class="xref">Appendix</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-B.1" class="xref">B.1</a>.  <a href="#name-syntax" class="xref">Syntax</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#appendix-B.2" class="xref">B.2</a>.  <a href="#name-object-examples" class="xref">Object examples</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#appendix-B.3" class="xref">B.3</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="status">
<section id="section-1">
      <h2 id="name-status">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-status" class="section-name selfRef">Status</a>
      </h2>
<p id="section-1-1">This document is fully work in progress.<a href="#section-1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="introduction">
<section id="section-2">
      <h2 id="name-introduction">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-2-1">This protocol extends upon the Non-Fungible Token (NFT) ERC-721 standard. It enables digital assets to become connected with a physical counterpart, as well as the other way around; physical assets can be immortalized on any distributed ledger that supports smart contracts by minting a cryptographically connected token.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This specification defines the core functionalities: registering and claiming the digital ownership of a physical item. It also describes the security and privacy considerations for usage.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">Additionally, the protocol includes specifications on physical item verification and the management of the physical item manufactures in the context of this novel ecosystem.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">From a philosophical perspective, this protocol is aiming to merge and connect items from the real (tangible and physical) world into digital universes, following the interconnected metaverse principles. Through this protocol and extensions thereof, it is possible to create eternal references in the metaverse possibly going way beyond the lifetime of the physical item. Common terms for such approaches are often referred to as digital twins or totality.
The authors are aware that this is an ambitious project, though multiple other parties are working on similar approaches which commonly are proprietary, closed source and not agnostic.
The goal with this specification is to lay out a common standardized foundation that allows to be extended upon in a collaborative approach.<a href="#section-2-4" class="pilcrow">¶</a></p>
<div id="roles">
<section id="section-2.1">
        <h3 id="name-roles">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-roles" class="section-name selfRef">Roles</a>
        </h3>
<p id="section-2.1-1">The following participants are involved as part of the protocol communication flows.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<div id="item">
<section id="section-2.1.1">
          <h4 id="name-item">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-item" class="section-name selfRef">Item</a>
          </h4>
<p id="section-2.1.1-1">The physical Item lies at the core of the protocol. An Item is brought to life by a Creator. For example Fashion Brand XYZ designing and producing Fashion Item 123. The value in the MetaBridge protocol and an implementation thereof rises linear to the value of the physical Item, though the protocol is laid out to be as generic as possible and can work with any Item, independently from its value.
This protocol can work with any Item wherein an NFC tag can be fully integrated and be readable with an external device. The removal of an NFC tag should require force and result in visible damage to the item, such that tampering is recognizable/detected.<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ancnft-pnft">
<section id="section-2.1.2">
          <h4 id="name-ancnft-pnft">
<a href="#section-2.1.2" class="section-number selfRef">2.1.2. </a><a href="#name-ancnft-pnft" class="section-name selfRef">ancNFT / pNFT</a>
          </h4>
<p id="section-2.1.2-1">Once a physical Item has passed through the protocol, a tokenized version is created. It is now fully representable by this alternate NFT, called a pNFT (physical NFT) or ancNFT ((crypto) anchored NFT) . The intention of the pNFT is to be traded on the open market. Additionally, it could be used as a collateral for borrowing/lending applications in DeFi applications, assuming enough liquidity exists.<a href="#section-2.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="creator">
<section id="section-2.1.3">
          <h4 id="name-creator">
<a href="#section-2.1.3" class="section-number selfRef">2.1.3. </a><a href="#name-creator" class="section-name selfRef">Creator</a>
          </h4>
<p id="section-2.1.3-1">Any physical item with integrity requirements has been thoughtfully designed by a Creator. The Creator is synonymous for any designer, artist, company or person that creates Items. The Creator kicks of the lifespan of an Item once he decides to produce it and bring his idea or invention to life. It is in his responsibility to actively decide whether or not the Item is intended to become tokenized on the blockchain in the form of a pNFT and thereby requires the item to walk through the different stages of the MetaBridge Protocol in conjunction with the User .<a href="#section-2.1.3-1" class="pilcrow">¶</a></p>
<p id="section-2.1.3-2">If he chooses to do so, he will need to responsibly implement the MetaBridge Protocol (or choose an appropriate and certified implementation at hand for his specific use-case) and ensure to follow the listed Tag requirements . Most likely, this kind of integration and intervention into the product makes sense with newly designed Items that already have the advantages and aspects of the protocol in mind. Though, it is also possible to "upgrade" old Items to support the MetaBridge protocol simply by finding an appropriate spot to attach the NFC chip on.<a href="#section-2.1.3-2" class="pilcrow">¶</a></p>
<p id="section-2.1.3-3">Unlike other protocols, the creator does not become the original owner of the item. Instead, he only registers the item in the smartcontract and keeps it open for the user to claim and thereby mint the first genesis pNFT. The creator could of course also claim the item himself, though this is not necessarily the intention of the MetaBridge protocol. Instead, once the item has been registered, gaining the ownership of the item is intentionally not based on the key pair of the Creator. As described in section XXX, the User can follow a simple two factor process that does not require the Creator to access his key pair anymore after he has handed out the claiming code.<a href="#section-2.1.3-3" class="pilcrow">¶</a></p>
<p id="section-2.1.3-4">This allows for a more trustless environment when reselling items in for example stores, etc. where the security of the operations might not be on par with the centralistic key management of the Creator. Instead, he can freely produce his items, hand them out to resellers and stores together with the claiming codes, without providing access and the necessitiy for his key pair to be interacted with. This requires a lower level of trust in the merchants.<a href="#section-2.1.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="user">
<section id="section-2.1.4">
          <h4 id="name-user">
<a href="#section-2.1.4" class="section-number selfRef">2.1.4. </a><a href="#name-user" class="section-name selfRef">User</a>
          </h4>
<p id="section-2.1.4-1">Users of the protocol can verify, claim and transfer items between each other. Once he claims a item and comes in the physical posession of it, he also becomes an owner.
He is an independent party from the creator and is interested in gaining ownership of a physical item or the corresponding token.<a href="#section-2.1.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="distributed-ledger-smart-contract-platform">
<section id="section-2.1.5">
          <h4 id="name-distributed-ledger-smart-co">
<a href="#section-2.1.5" class="section-number selfRef">2.1.5. </a><a href="#name-distributed-ledger-smart-co" class="section-name selfRef">Distributed Ledger (Smart Contract Platform)</a>
          </h4>
<p id="section-2.1.5-1">This protocol is supposed to be implemented on a distributed ledger, since it is in the intention of the authors that ownwership rights are not managed in centralistic databases. Noone should be able to alter or manipulate your belongings -- not even the state. The idea of the protocol is to become the template for indenpendent hyper structures on several distributed ledgers. Thus, the protocol is supposed to be implemented as a smartcontract and the intention is to be smart contract platform agnostic.<a href="#section-2.1.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="protocol-flow">
<section id="section-2.2">
        <h3 id="name-protocol-flow">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-protocol-flow" class="section-name selfRef">Protocol Flow</a>
        </h3>
<p id="section-2.2-1">The protocol, in abstract, follows the following steps:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.2-2">
<li id="section-2.2-2.1">The Creator registers the Item with the smart contract<a href="#section-2.2-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.2-2.2">An out-of-band transaction between the Creator and the User takes place<a href="#section-2.2-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-2.2-2.3">The Creator transmits the Claim Code to the User<a href="#section-2.2-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-2.2-2.4">The User verifies the authenticity of the Item in conjunction with the ledger<a href="#section-2.2-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-2.2-2.5">The User request a proof of physical possession from the Item<a href="#section-2.2-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-2.2-2.6">Together with the Claim Code and the proof of physical possession, the User requests to claim the Item at the ledger<a href="#section-2.2-2.6" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="interoperability">
<section id="section-2.3">
        <h3 id="name-interoperability">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-interoperability" class="section-name selfRef">Interoperability</a>
        </h3>
<p id="section-2.3-1">While other protocols follows very proprietary and non-accessible approaches, the goal for this specification is to outlay a foundation of interoperability which is agnostic to any distributed ledger and smart contract platform. This protocol shall serve as a template for future implementations and can be extended upon by the community. Therefor, some of the descriptions are also generic and are up to the implementor to define in more technical details depending on the platform he is using. Nevertheless, the principles and protocol steps should always remain at the core.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="tagobject-registration">
<section id="section-3">
      <h2 id="name-tag-object-registration">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-tag-object-registration" class="section-name selfRef">Tag/Object registration</a>
      </h2>
<div id="tag-requirements">
<section id="section-3.1">
        <h3 id="name-tag-requirements">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-tag-requirements" class="section-name selfRef">Tag requirements</a>
        </h3>
<p id="section-3.1-1">In order to connect the physical Item with the digital world, every Item is augmented with an NFC-Tag (other options might be possible). The tag contains information that unambiguously identify the product and provides the core functionality for the digital transfer. The following requirements must be fulfilled:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div id="general-requirements">
<section id="section-3.1.1">
          <h4 id="name-general-requirements">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-general-requirements" class="section-name selfRef">General Requirements</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-3.1.1-1.1">Capable of securely storing an asymmetric key pair<a href="#section-3.1.1-1.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.1-1.2">Be able to produce digital signatures of arbitrary messages on request<a href="#section-3.1.1-1.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.1-1.3">Optional: Capable of storing certificates<a href="#section-3.1.1-1.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="hardware-requirements">
<section id="section-3.1.2">
          <h4 id="name-hardware-requirements">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-hardware-requirements" class="section-name selfRef">Hardware Requirements</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-3.1.2-1.1">NFC capabilities including the antenna (with a minimum size to actually make it scannable via a mobile phone)<a href="#section-3.1.2-1.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.2-1.2">High durability (washable, bendable, protected against heat, etc.)<a href="#section-3.1.2-1.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.2-1.3">Optional: Tamper detection<a href="#section-3.1.2-1.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="additional-assumptions">
<section id="section-3.1.3">
          <h4 id="name-additional-assumptions">
<a href="#section-3.1.3" class="section-number selfRef">3.1.3. </a><a href="#name-additional-assumptions" class="section-name selfRef">Additional Assumptions</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-3.1.3-1.1">The tag is fully integrated into the Item<a href="#section-3.1.3-1.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.3-1.2">The removal of the tag should require force and result in visible damage to the Item, such that tampering is recognizable/detected either damaging the Item or tag permanently.<a href="#section-3.1.3-1.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="tag-identifier">
<section id="section-3.2">
        <h3 id="name-tag-identifier">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-tag-identifier" class="section-name selfRef">Tag identifier</a>
        </h3>
<p id="section-3.2-1">One of the key requirements that leverages a seamless tracking of the tangible product in the digital world, is the tags' capability of storing a cryptographic key pair consisting of a public and private key. The pair is associated with the tag during its production and besides its cryptographic purpose of signing and verifying messages using the private and public key respectively, the public key serves another important role, that is, it uniquely identifies the tag.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<div id="lookup-metadata">
<section id="section-3.2.1">
          <h4 id="name-lookup-metadata">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-lookup-metadata" class="section-name selfRef">Lookup Metadata</a>
          </h4>
<p id="section-3.2.1-1">In the course of the product registration, the Creator reads the public key from the tag and stores it on the ledger as part of a certificate alongside other metadata. The User, on the other side, can later retrieve this data by querying the ledger using the public key as an identifier.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verify-proof-of-possession">
<section id="section-3.2.2">
          <h4 id="name-verify-proof-of-possession">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-verify-proof-of-possession" class="section-name selfRef">Verify Proof-of-Possession</a>
          </h4>
<p id="section-3.2.2-1">In order to digitally claim ownership over an Item, a User needs two components. First a Claim Code, which can be obtained with the Item purchase, and second, a Proof-of-Possession (PoP) of the physical Item. During this process, the Claim Code and PoP, which is a signature produced by the product, are sent to the ledger. The ledger later uses the public key of the Item to check the validity of the Proof-of-Possession.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="protocolsmartcontract-endpoints">
<section id="section-4">
      <h2 id="name-protocol-smartcontract-endp">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-protocol-smartcontract-endp" class="section-name selfRef">Protocol/Smartcontract endpoints</a>
      </h2>
<p id="section-4-1">This section describes the fixed endpoints that any smartcontract intending to follow the protocol should at least have.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="query-identifier">
<section id="section-4.1">
        <h3 id="name-query-identifier">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-query-identifier" class="section-name selfRef">Query identifier</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-4.1-1">
<pre>
@notice Retrieve object information
@param pk_hash_object A compact representation of the object's public key
@return Data associated with the object
function queryObject(bytes32 pk_hash_object) external view returns (object memory);
</pre><a href="#section-4.1-1" class="pilcrow">¶</a>
</div>
<p id="section-4.1-2">This function allows the retrieval of object information stored on the ledger. It requires the public key of the object within a compact form (i.e. hashed) and returns a struct containing metadata of the aforementioned. This is a straight forward function, that uses the hash of the public key to look up the metadata that was registered together with the object.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="register-object">
<section id="section-4.2">
        <h3 id="name-register-object">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-register-object" class="section-name selfRef">Register object</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-4.2-1">
<pre>
@notice Register an object on the ledger
@param pk_object The public key of the object
@param c_hash The hash of the claim_code
@param o_reg A Signature of claim_code and c_hash, signed by the creator
@param pk_creator Public key of the creator
@return Indicates whether the registration was successful
function registerObject(pkey pk_object, bytes32 c_hash, sig o_reg, pkey pk_creator) external view returns (bool);
</pre><a href="#section-4.2-1" class="pilcrow">¶</a>
</div>
<p id="section-4.2-2">This function can be used to register a new object in the ecosystem. It requires the public keys of both, object and creator, together with the c_hash, which basically is the hashed claim_code and a signature over the concatenation of object public key and c_hash. It returns a bool, indicating whether the registering process was a successful. As a first step the function has to check whether there was an object already registered with the same public key, in that case function just returns false. Otherwise, it has to verify whether the creator is approved in some way, i.e. by fetching a list from an external service or requesting it from another smart-contract. Now it has to be checked whether the issued o_reg-signature is valid. This ensures that in fact an authorized creator submitted the object for registration. If any of the previous checks failed the function returns false otherwise it returns true and the object is ready to be claimed.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="claim-object">
<section id="section-4.3">
        <h3 id="name-claim-object">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-claim-object" class="section-name selfRef">Claim object</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-4.3-1">
<pre>
@notice Claim an object for the given user
@param pk_object The public key of the object
@param pk_user The public key of the user
@param claim_code The secret required to claim the object
@param u_pop A Signature of claim_code and public key of the user, signed by the object
@param o_claim A Signature of u_pop, signed by the user
@return Indicates whether the claiming process was successful
function claimObject(pkey pk_object, pkey pk_user, byte32 claim_code, sig u_pop, sig o_claim) external view returns (bool);
</pre><a href="#section-4.3-1" class="pilcrow">¶</a>
</div>
<p id="section-4.3-2">This function allows a user to claim a previously registered object. It requires the public keys of object and user, together with the secret claim_code. Additionally, to u_pop, a signature of claim_code and public key of the user, signed by the object and o_claim which is a signature of u_pop, created by the user. It returns a flag that indicates success or failure. In order to verify whether a claiming is possible, the function first checks whether c_hash, which was registered together with the object, is an actual hash of the claim_code. Next, it validates whether u_pop is a valid signature of the same claim_code, concatenated with the public key of the user created by the object. The function must also check at this point, if the object is indeed claimable, which means correctly registered and not claimed before. As a next step, o_claim has to be validated as a signature of u_pop under the public key of the user. If all checks have passed, give ownership to the user and return true otherwise return false.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="claiming-ownership">
<section id="section-5">
      <h2 id="name-claiming-ownership">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-claiming-ownership" class="section-name selfRef">Claiming ownership</a>
      </h2>
<p id="section-5-1">The claiming-protocol intends to convey the ownership rights of an object, and its representative on the blockchain, from the manufacturer to a user. This process is one of the most critical parts of the whole system as it has to considerate practical aspects (like store purchases) on the one hand, but on the other hand also has high security demands due to possibly severe implications for participating member e.g. when transferring luxury goods. The key idea behind this protocol is to utilize cryptographically secure hash functions together with unforgeable digital signatures to build a system which allows for a two-factor authorization consisting of a knowledge- and an ownership aspect.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">In short, to claim an object, the user has to prove:<a href="#section-5-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5-3">
<li id="section-5-3.1">Ownership of the object, utilizing the object's capability to produce signatures<a href="#section-5-3.1" class="pilcrow">¶</a>
</li>
        <li id="section-5-3.2">Knowledge of a claiming code, issued to the user during the purchase phase<a href="#section-5-3.2" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-5-4">At this point in time, the object was already registered on the blockchain. During the aforementioned step, the object's identity <em>pk_o</em> was associated with the hash value of the claiming code <em>c_hash = Hash(claim_code)</em>. The <em>claim_code</em> however is a secret only known to the manufacturer.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">The process of transferring the object from the manufacturer to the user know works as follows:<a href="#section-5-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5-6">
<li id="section-5-6.1">During the purchase, the <em>claim_code</em> is handed over to the user (e.g. on the receipt)<a href="#section-5-6.1" class="pilcrow">¶</a>
</li>
        <li id="section-5-6.2">The user now makes use of the object's signing features to create a proof-of-possession <em>u_pop</em>, which is a signature over the <em>claim code</em> concatenated with the user's public key <em>pk_u</em>, created with the secret key of the object <em>sk_o</em><a href="#section-5-6.2" class="pilcrow">¶</a>
</li>
        <li id="section-5-6.3">In order to create a binding between user and object, <em>u_pop</em> is signed by the user using her private key <em>sk_u</em> resulting in a signature <em>o_claim</em><a href="#section-5-6.3" class="pilcrow">¶</a>
</li>
        <li id="section-5-6.4">
          <em>claim_code</em>, <em>o_claim</em> and <em>u_pop</em> are then transferred to the ledger<a href="#section-5-6.4" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-5-7">In order to verify the user's access to the object and knowledge of the claiming code, the ledger now checks that:<a href="#section-5-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5-8">
<li id="section-5-8.1">The <em>claim_code</em> is the preimage of the <em>c_hash</em><a href="#section-5-8.1" class="pilcrow">¶</a>
</li>
        <li id="section-5-8.2">
          <em>u_pop</em> can be verified with the public key of the object <em>pk_o</em><a href="#section-5-8.2" class="pilcrow">¶</a>
</li>
        <li id="section-5-8.3">
          <em>o_claim</em> can be verified with the public key of the user <em>pk_u</em><a href="#section-5-8.3" class="pilcrow">¶</a>
</li>
      </ol>
</section>
</div>
<div id="transfering-ownership">
<section id="section-6">
      <h2 id="name-transfering-ownership">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-transfering-ownership" class="section-name selfRef">Transfering ownership</a>
      </h2>
<p id="section-6-1">Once an object has been claimed, its possession rights can be further transferred to another user. This covers the case when the associated real world counterpart is given away or sold. The goal is to keep this process as simple as possible and to minimize the interaction between owner and receiver. In order to transfer an object, the owner needs:<a href="#section-6-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6-2">
<li id="section-6-2.1">Possession of the private key <em>sk_ow</em>, which belongs to the public key <em>pk_ow</em> to which the object is registered<a href="#section-6-2.1" class="pilcrow">¶</a>
</li>
        <li id="section-6-2.2">Knowledge of the public key <em>pk_re</em> of the receiver<a href="#section-6-2.2" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-6-3">If those requirements are met, the owner can initiate a transfer without any further input of the receiver. This means that the receiver is not required to accept, but is also not able to deny, the object to be transferred. The owner issues a signed transfer request (specification needed) to the ledger which verifies whether the signature is valid under <em>pk_ow</em> and in case of success the new owner of the object is <em>pk_re</em>.<a href="#section-6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verifying-ownership">
<section id="section-7">
      <h2 id="name-verifying-ownership">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-verifying-ownership" class="section-name selfRef">Verifying ownership</a>
      </h2>
<p id="section-7-1">With the help of this protocol, the user is able to verify the validity of the product in hand. The specification thereby provides distinct verification cycles depending on whether there is an active internet connection available and/or the tag is able to store certificates. Inherently, the online verification process is the preferred variant due to the availability of the most recent data, providing the highest level of security. In contrast, the offline verification protocol relies on cached data and acts a backup solution for remote places.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">To perform the <em>High level (online) verification</em>, the user follows the subsequent steps:<a href="#section-7-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7-3">
<li id="section-7-3.1">Read the public key <em>pk_o</em> from the tag<a href="#section-7-3.1" class="pilcrow">¶</a>
</li>
        <li id="section-7-3.2">Query the ledger by <em>pk_o</em> in order to obtain claiming transaction artifacts<a href="#section-7-3.2" class="pilcrow">¶</a>
</li>
        <li id="section-7-3.3">Get a list of brands from a suitable source (ledger, external webserver, ...)<a href="#section-7-3.3" class="pilcrow">¶</a>
</li>
        <li id="section-7-3.4">Verify the received certificates against the list of brands<a href="#section-7-3.4" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-7-4">To perform the <em>Medium level (offline) verification</em>, the user follows the subsequent steps:<a href="#section-7-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7-5">
<li id="section-7-5.1">Read the product certificate from the tag<a href="#section-7-5.1" class="pilcrow">¶</a>
</li>
        <li id="section-7-5.2">Verify the received certificate against a previously stored list of brands<a href="#section-7-5.2" class="pilcrow">¶</a>
</li>
      </ol>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="assumptions">
<section id="section-8.1">
        <h3 id="name-assumptions">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-assumptions" class="section-name selfRef">Assumptions</a>
        </h3>
<ol start="1" type="1" class="normal type-1" id="section-8.1-1">
<li id="section-8.1-1.1">The cryptographic key pair on the chip is stored securely<a href="#section-8.1-1.1" class="pilcrow">¶</a>
</li>
          <li id="section-8.1-1.2">The Creator and User are responsible for their own secure key management<a href="#section-8.1-1.2" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="mathematical-proof">
<section id="section-8.2">
        <h3 id="name-mathematical-proof">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-mathematical-proof" class="section-name selfRef">(Mathematical proof)</a>
      </h3>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-9">
      <h2 id="name-privacy-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy considerations</a>
      </h2>
<p id="section-9-1">TODO Security<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="references">
<section id="appendix-A">
      <h2 id="name-references">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-references" class="section-name selfRef">References</a>
    </h2>
</section>
</div>
<div id="appendix">
<section id="appendix-B">
      <h2 id="name-appendix">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-appendix" class="section-name selfRef">Appendix</a>
      </h2>
<div id="syntax">
<section id="appendix-B.1">
        <h3 id="name-syntax">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-syntax" class="section-name selfRef">Syntax</a>
      </h3>
</section>
</div>
<div id="object-examples">
<section id="appendix-B.2">
        <h3 id="name-object-examples">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-object-examples" class="section-name selfRef">Object examples</a>
        </h3>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-B.3">
        <h3 id="name-acknowledgements">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h3>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Yannik Goldgräbe</span></div>
<div dir="auto" class="left"><span class="org">yannik.gold</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hi@yannik.gold" class="email">hi@yannik.gold</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marco Lewandowsky</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marco.lewandowsky@gmail.com" class="email">marco.lewandowsky@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
